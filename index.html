<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <title>Klotski solver</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    input[type="number"], input[type="text"] { width: 4em; }
    label { margin-right: 10px; }
    button { margin: 5px; padding: 5px 10px; }
    pre { background: #f0f0f0; padding: 10px; white-space: pre-wrap; }
    #board {
      display: grid;
      grid-template-rows: repeat(5, 50px);
      grid-template-columns: repeat(4, 50px);
      gap: 2px;
      background: #ccc;
      width: max-content;
      border: 2px solid #888;
      margin: 20px 0;
    }
    .block {
      position: relative;
      border-radius: 6px;
      border: 2px solid #444;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: #222;
      font-size: 1.2em;
      box-sizing: border-box;
      z-index: 1;
    }
    .block.A { background: #e74c3c; color: #fff; }
    .block.B { background: #3498db; color: #fff; }
    .block.C { background: #f1c40f; color: #222; }
    .block.D { background: #2ecc40; color: #fff; }
    
    /* Styling för tomma celler */
    .empty-cell {
      background: #f9f9f9;
      border: 1px dashed #ccc;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #999;
      font-size: 1.5em;
      min-height: 48px;
      min-width: 48px;
      box-sizing: border-box;
    }

    .empty-cell:focus {
      outline: 2px solid #007acc;
      background: #e6f3ff;
    }

    /* Markera utgångspositioner */
    .exit-cell {
      background: #ffe4b3 !important;
      border: 2px solid #ff9800 !important;
    }
    
    /* Styling för grattismeddelande */
    .success-message {
      background: linear-gradient(135deg, #4CAF50, #45a049);
      color: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      margin: 20px 0;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      font-size: 1.2em;
      font-weight: bold;
      animation: celebration 0.6s ease-in-out;
    }
    
    @keyframes celebration {
      0% { transform: scale(0.8); opacity: 0; }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); opacity: 1; }
    }
    
    .success-message .emoji {
      font-size: 2em;
      display: block;
      margin-bottom: 10px;
    }

    /* Mobilvänlig CSS för telefoner och surfplattor */
    @media (max-width: 768px) {
      body { 
        margin: 10px; 
        font-size: 14px;
      }
      
      h1 { 
        font-size: 1.5em; 
        margin-bottom: 15px;
      }
      
      h2 { 
        font-size: 1.2em; 
        margin-top: 20px;
      }
      
      /* Mindre bräde för mobil */
      #board {
        grid-template-columns: repeat(4, 45px);
        grid-template-rows: repeat(5, 45px);
        gap: 1px;
        margin: 15px auto;
      }
      
      /* Anpassa block och celler */
      .block, .empty-cell {
        font-size: 0.9em;
        min-height: 43px;
        min-width: 43px;
      }
      
      /* Större knappar för touch */
      button {
        padding: 12px 16px;
        margin: 8px 4px;
        font-size: 16px; /* Viktigt för iOS - förhindrar zoom */
        min-height: 44px; /* Apple's rekommenderade touch-storlek */
      }
      
      /* Responsiva formulär */
      fieldset {
        padding: 10px;
        margin-bottom: 15px;
      }
      
      label {
        display: block;
        margin-bottom: 8px;
        margin-right: 0;
      }
      
      select, input[type="number"] {
        width: 100%;
        max-width: 150px;
        padding: 8px;
        font-size: 16px; /* Förhindrar zoom på iOS */
      }
      
      /* Mindre text i output */
      #output {
        font-size: 13px;
        padding: 8px;
      }
      
      /* Anpassa blocklista */
      #blocksList ul {
        padding-left: 15px;
      }
      
      #blocksList li {
        margin-bottom: 8px;
        font-size: 14px;
      }
    }

    /* Extra små skärmar (telefoner i porträttläge) */
    @media (max-width: 480px) {
      #board {
        grid-template-columns: repeat(4, 35px);
        grid-template-rows: repeat(5, 35px);
      }
      
      .block, .empty-cell {
        font-size: 0.8em;
        min-height: 33px;
        min-width: 33px;
      }
      
      button {
        padding: 10px 12px;
        font-size: 14px;
      }
      
      h1 {
        font-size: 1.3em;
      }
    }

    /* Dölj stegknappar tills en lösning finns */
.step-navigation {
  display: none;
}

.step-navigation.visible {
  display: block;
}

/* Dölj sparaknapp tills en lösning finns */
.save-button {
  display: none;
}

.save-button.visible {
  display: inline-block;
}
  </style>
</head>
<body>
  <h1>Klotski Solver</h1>

  <div>
    <p><strong>Brädet:</strong> 5×4 rutor (5 rader, 4 kolumner)</p>
    <p><strong>Utgång:</strong> Rad 5, kolumn 2-3 (längst ner i mitten)</p>
  </div>

  <h2>Block</h2>
  <div id="blocksList" aria-live="polite" tabindex="0"></div>

  <fieldset aria-labelledby="addBlockLegend">
    <legend id="addBlockLegend">Lägg till block</legend>
    <label>Blocktyp: 
      <select id="blkType" aria-label="Välj blocktyp">
        <option value="A">A - Stort block (2×2, rött målblock)</option>
        <option value="B">B - Vertikalt block (2×1)</option>
        <option value="C">C - Horisontellt block (1×2)</option>
        <option value="D">D - Litet block (1×1)</option>
      </select>
    </label>
    <label>Rad (1-5): <input type="number" id="blkY" value="1" min="1" max="5" aria-label="Rad"></label>
    <label>Kolumn (1-4): <input type="number" id="blkX" value="1" min="1" max="4" aria-label="Kolumn"></label>
    <button id="addBlockBtn" aria-label="Lägg till block">Lägg till block</button>
  </fieldset>

  <button id="solveBtn" aria-label="Lös pussel">Lös pussel</button>
<button id="saveBtn" class="save-button" aria-label="Spara lösning">Spara lösning</button>
  <button id="setupStandardBtn" aria-label="Sätt upp standard Klotski-pussel">Standarduppsättning</button>
  <button id="clearBtn" aria-label="Rensa brädet">Rensa brädet</button>

  <h2>Grafiskt bräde:</h2>
  <div id="board" aria-label="Klotski-bräde" tabindex="0"></div>

  <h2>Output / Lösning:</h2>
  <pre id="output" aria-live="polite" role="status"></pre>

  <div class="step-navigation" id="stepNavigation">
    <button id="prevStepBtn" disabled>Föregående</button>
    <button id="nextStepBtn" disabled>Nästa</button>
  </div>

<script src="klotski-solver.js"></script>
  </body>
</html>
